<!DOCTYPE html>
<html>
<head>
    <title>QR Code Test</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Arial, sans-serif; margin: 50px; }
        .container { max-width: 800px; margin: 0 auto; text-align: center; }
        .qr-test { margin: 30px 0; padding: 20px; border: 2px solid #ddd; border-radius: 10px; }
        .qr-test h3 { color: #333; }
        .qr-test img { max-width: 200px; border: 1px solid #ccc; }
        .secret { background: #f5f5f5; padding: 10px; border-radius: 5px; font-family: monospace; }
        .btn { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        .btn:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Two-Factor Authentication QR Code Test</h1>
        <p>‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• QR Code ‡∏ó‡∏±‡πâ‡∏á 3 ‡∏ß‡∏¥‡∏ò‡∏µ</p>
        
        <div class="qr-test">
            <h3>1. Base64 SVG Data URL</h3>
            <img id="qr-base64" src="" alt="QR Code Base64" style="display: none;">
            <div id="base64-loading">Loading...</div>
        </div>
        
        <div class="qr-test">
            <h3>2. Google Charts API</h3>
            <img id="qr-google" src="" alt="QR Code Google Charts" style="display: none;">
        </div>
        
        <div class="qr-test">
            <h3>3. Raw SVG</h3>
            <div id="qr-svg-container"></div>
        </div>
        
        <div class="secret">
            <strong>Secret Key:</strong> <span id="secret-key">Loading...</span>
        </div>
        
        <button class="btn" onclick="generateQR()">‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡πÉ‡∏´‡∏°‡πà</button>
        <button class="btn" onclick="testLaravelQR()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö Laravel QR</button>
    </div>

    <script>
        // Generate QR Code for testing
        function generateQR() {
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á secret key ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢
            const secret = 'JBSWY3DPEHPK3PXP'; // Example secret
            const email = 'test@example.com';
            const issuer = 'Laravel Auth Test';
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á TOTP URL
            const qrUrl = `otpauth://totp/${encodeURIComponent(issuer)}:${encodeURIComponent(email)}?secret=${secret}&issuer=${encodeURIComponent(issuer)}&algorithm=SHA1&digits=6&period=30`;
            
            document.getElementById('secret-key').textContent = secret;
            
            // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Google Charts
            const googleChartsUrl = `https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=${encodeURIComponent(qrUrl)}`;
            const googleImg = document.getElementById('qr-google');
            googleImg.src = googleChartsUrl;
            googleImg.style.display = 'block';
            
            // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: ‡πÉ‡∏ä‡πâ qrcode.js library
            loadQRCodeLibrary().then(() => {
                const qr = new QRCode(document.getElementById('qr-svg-container'), {
                    text: qrUrl,
                    width: 200,
                    height: 200,
                    colorDark: '#000000',
                    colorLight: '#ffffff'
                });
            });
            
            console.log('QR URL:', qrUrl);
        }
        
        function testLaravelQR() {
            // ‡πÄ‡∏õ‡∏¥‡∏î Laravel 2FA setup page
            window.open('http://127.0.0.1:8000/2fa/setup', '_blank');
        }
        
        function loadQRCodeLibrary() {
            return new Promise((resolve) => {
                if (window.QRCode) {
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js';
                script.onload = resolve;
                document.head.appendChild(script);
            });
        }
        
        // Auto-generate on page load
        window.onload = generateQR;
    </script>
</body>
</html>
